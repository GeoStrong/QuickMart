import{F as D,r as M,K as we,n as Ie,E as je,a as Ae,b as Ee,N as ae,Q as Fe,T as Me,U as G,j as x,d as ke,V as Oe,W as k,s as ie,X as Pe,L as Re}from"./index-k63RGkMX.js";function se(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,a=Object.getOwnPropertySymbols(e);r<a.length;r++)t.indexOf(a[r])<0&&Object.prototype.propertyIsEnumerable.call(e,a[r])&&(n[a[r]]=e[a[r]]);return n}var Y;(function(e){e.event="event",e.props="prop"})(Y||(Y={}));function R(){}function Te(e){var t,n=void 0;return function(){for(var a=[],r=arguments.length;r--;)a[r]=arguments[r];return t&&a.length===t.length&&a.every(function(s,f){return s===t[f]})||(t=a,n=e.apply(void 0,a)),n}}function $(e){return!!(e||"").match(/\d/)}function H(e){return e==null}function De(e){return typeof e=="number"&&isNaN(e)}function Be(e){return H(e)||De(e)||typeof e=="number"&&!isFinite(e)}function _e(e){var t=M.useRef(e);t.current=e;var n=M.useRef(function(){for(var a=[],r=arguments.length;r--;)a[r]=arguments[r];return t.current.apply(t,a)});return n.current}function ue(e,t){return Array(t+1).join(e)}function Le(e){var t=e+"",n=t[0]==="-"?"-":"";n&&(t=t.substring(1));var a=t.split(/[eE]/g),r=a[0],s=a[1];if(s=Number(s),!s)return n+r;r=r.replace(".","");var f=1+s,c=r.length;return f<0?r="0."+ue("0",Math.abs(f))+r:f>=c?r=r+ue("0",f-c):r=(r.substring(0,f)||"0")+"."+r.substring(f),n+r}function Z(e,t){if(e.value=e.value,e!==null){if(e.createTextRange){var n=e.createTextRange();return n.move("character",t),n.select(),!0}return e.selectionStart||e.selectionStart===0?(e.focus(),e.setSelectionRange(t,t),!0):(e.focus(),!1)}}var $e=Te(function(e,t){for(var n=0,a=0,r=e.length,s=t.length;e[n]===t[n]&&n<r;)n++;for(;e[r-1-a]===t[s-1-a]&&s-a>n&&r-a>n;)a++;return{from:{start:n,end:r-a},to:{start:n,end:s-a}}});function Ke(e,t,n){return Math.min(Math.max(e,t),n)}function J(e){return Math.max(e.selectionStart,e.selectionEnd)}function Ue(){return typeof navigator<"u"&&!(navigator.platform&&/iPhone|iPod/.test(navigator.platform))}function qe(e){return{from:{start:0,end:0},to:{start:0,end:e.length},lastValue:""}}function le(e,t){return e===void 0&&(e=" "),typeof e=="string"?e:e[t]||" "}function Ge(e){var t=e.currentValue,n=e.formattedValue,a=e.currentValueIndex,r=e.formattedValueIndex;return t[a]===n[r]}function Ye(e,t,n,a,r,s,f){f===void 0&&(f=Ge);var c=r.findIndex(function(A){return A}),v=e.slice(0,c);!t&&!n.startsWith(v)&&(t=v,n=v+n,a=a+v.length);for(var g=n.length,m=e.length,b={},d=new Array(g),p=0;p<g;p++){d[p]=-1;for(var o=0,I=m;o<I;o++){var y=f({currentValue:n,lastValue:t,formattedValue:e,currentValueIndex:p,formattedValueIndex:o});if(y&&b[o]!==!0){d[p]=o,b[o]=!0;break}}}for(var h=a;h<g&&(d[h]===-1||!s(n[h]));)h++;var F=h===g||d[h]===-1?m:d[h];for(h=a-1;h>0&&d[h]===-1;)h--;var V=h===-1||d[h]===-1?0:d[h]+1;return V>F?F:a-V<F-a?V:F}function z(e,t,n,a){var r=e.length;if(t=Ke(t,0,r),a==="left"){for(;t>=0&&!n[t];)t--;t===-1&&(t=n.indexOf(!0))}else{for(;t<=r&&!n[t];)t++;t>r&&(t=n.lastIndexOf(!0))}return t===-1&&(t=r),t}function He(e){for(var t=Array.from({length:e.length+1}).map(function(){return!0}),n=0,a=t.length;n<a;n++)t[n]=!!($(e[n])||$(e[n-1]));return t}function ze(e,t,n,a,r,s){s===void 0&&(s=R);var f=_e(function(o,I){var y,h;return Be(o)?(h="",y=""):typeof o=="number"||I?(h=typeof o=="number"?Le(o):o,y=a(h)):(h=r(o,void 0),y=a(h)),{formattedValue:y,numAsString:h}}),c=M.useState(function(){return f(H(e)?t:e,n)}),v=c[0],g=c[1],m=function(o,I){o.formattedValue!==v.formattedValue&&g({formattedValue:o.formattedValue,numAsString:o.value}),s(o,I)},b=e,d=n;H(e)&&(b=v.numAsString,d=!0);var p=f(b,d);return M.useMemo(function(){g(p)},[p.formattedValue]),[v,m]}function We(e){return e.replace(/[^0-9]/g,"")}function Qe(e){return e}function Xe(e){var t=e.type;t===void 0&&(t="text");var n=e.displayType;n===void 0&&(n="input");var a=e.customInput,r=e.renderText,s=e.getInputRef,f=e.format;f===void 0&&(f=Qe);var c=e.removeFormatting;c===void 0&&(c=We);var v=e.defaultValue,g=e.valueIsNumericString,m=e.onValueChange,b=e.isAllowed,d=e.onChange;d===void 0&&(d=R);var p=e.onKeyDown;p===void 0&&(p=R);var o=e.onMouseUp;o===void 0&&(o=R);var I=e.onFocus;I===void 0&&(I=R);var y=e.onBlur;y===void 0&&(y=R);var h=e.value,F=e.getCaretBoundary;F===void 0&&(F=He);var V=e.isValidInputCharacter;V===void 0&&(V=$);var A=e.isCharacterSame,O=se(e,["type","displayType","customInput","renderText","getInputRef","format","removeFormatting","defaultValue","valueIsNumericString","onValueChange","isAllowed","onChange","onKeyDown","onMouseUp","onFocus","onBlur","value","getCaretBoundary","isValidInputCharacter","isCharacterSame"]),K=ze(h,v,!!g,f,c,m),ee=K[0],N=ee.formattedValue,U=ee.numAsString,fe=K[1],q=M.useRef({formattedValue:N,numAsString:U}),te=function(i,u){q.current={formattedValue:i.formattedValue,numAsString:i.value},fe(i,u)},re=M.useState(!1),ce=re[0],de=re[1],B=M.useRef(null),T=M.useRef({setCaretTimeout:null,focusTimeout:null});M.useEffect(function(){return de(!0),function(){clearTimeout(T.current.setCaretTimeout),clearTimeout(T.current.focusTimeout)}},[]);var ve=f,W=function(i,u){var l=parseFloat(u);return{formattedValue:i,value:u,floatValue:isNaN(l)?void 0:l}},P=function(i,u,l){i.selectionStart===0&&i.selectionEnd===i.value.length||(Z(i,u),T.current.setCaretTimeout=setTimeout(function(){i.value===l&&i.selectionStart!==i.selectionEnd&&Z(i,u)},0))},_=function(i,u,l){return z(i,u,F(i),l)},Q=function(i,u,l){var S=F(u),w=Ye(u,N,i,l,S,V,A);return w=z(u,w,S),w},me=function(i){var u=i.formattedValue;u===void 0&&(u="");var l=i.input,S=i.setCaretPosition;S===void 0&&(S=!0);var w=i.source,C=i.event,j=i.numAsString,E=i.caretPos;if(l){if(E===void 0&&S){var L=i.inputValue||l.value,X=J(l);l.value=u,E=Q(L,u,X)}l.value=u,S&&E!==void 0&&P(l,E,u)}u!==N&&te(W(u,j),{event:C,source:w})};M.useEffect(function(){var i=q.current,u=i.formattedValue,l=i.numAsString;N!==u&&(N!==U||u!==l)&&te(W(N,U),{event:void 0,source:Y.props})},[N,U]);var ge=B.current?J(B.current):void 0,he=typeof window<"u"?M.useLayoutEffect:M.useEffect;he(function(){var i=B.current;if(N!==q.current.formattedValue&&i){var u=Q(q.current.formattedValue,N,ge);i.value=N,P(i,u,N)}},[N]);var pe=function(i,u,l){var S=$e(N,i),w=Object.assign(Object.assign({},S),{lastValue:N}),C=c(i,w),j=ve(C);if(C=c(j,void 0),b&&!b(W(j,C))){var E=u.target,L=J(E),X=Q(i,N,L);return E.value=N,P(E,X,N),!1}return me({formattedValue:j,numAsString:C,inputValue:i,event:u,source:l,setCaretPosition:!0,input:u.target}),!0},xe=function(i){var u=i.target,l=u.value,S=pe(l,i,Y.event);S&&d(i)},ye=function(i){var u=i.target,l=i.key,S=u.selectionStart,w=u.selectionEnd,C=u.value;C===void 0&&(C="");var j;if(l==="ArrowLeft"||l==="Backspace"?j=Math.max(S-1,0):l==="ArrowRight"?j=Math.min(S+1,C.length):l==="Delete"&&(j=S),j===void 0||S!==w){p(i);return}var E=j;if(l==="ArrowLeft"||l==="ArrowRight"){var L=l==="ArrowLeft"?"left":"right";E=_(C,j,L),E!==j&&i.preventDefault()}else l==="Delete"&&!V(C[j])?E=_(C,j,"right"):l==="Backspace"&&!V(C[j])&&(E=_(C,j,"left"));E!==j&&P(u,E,C),i.isUnitTestRun&&P(u,E,C),p(i)},Ce=function(i){var u=i.target,l=u.selectionStart,S=u.selectionEnd,w=u.value;if(w===void 0&&(w=""),l===S){var C=_(w,l);C!==l&&P(u,C,w)}o(i)},be=function(i){i.persist&&i.persist();var u=i.target;B.current=u,T.current.focusTimeout=setTimeout(function(){var l=u.selectionStart,S=u.selectionEnd,w=u.value;w===void 0&&(w="");var C=_(w,l);C!==l&&!(l===0&&S===w.length)&&P(u,C,w),I(i)},0)},Ve=function(i){B.current=null,clearTimeout(T.current.focusTimeout),clearTimeout(T.current.setCaretTimeout),y(i)},Ne=ce&&Ue()?"numeric":void 0,ne=Object.assign({inputMode:Ne},O,{type:t,value:N,onChange:xe,onKeyDown:ye,onMouseUp:Ce,onFocus:be,onBlur:Ve});if(n==="text")return r?D.createElement(D.Fragment,null,r(N,O)||null):D.createElement("span",Object.assign({},O,{ref:s}),N);if(a){var Se=a;return D.createElement(Se,Object.assign({},ne,{ref:s}))}return D.createElement("input",Object.assign({},ne,{ref:s}))}function Je(e,t){var n=t.format,a=t.allowEmptyFormatting,r=t.mask,s=t.patternChar;if(s===void 0&&(s="#"),e===""&&!a)return"";for(var f=0,c=n.split(""),v=0,g=n.length;v<g;v++)n[v]===s&&(c[v]=e[f]||le(r,f),f+=1);return c.join("")}function Ze(e,t,n){t===void 0&&(t=qe(e));var a=n.format,r=n.patternChar;r===void 0&&(r="#");var s=t.from,f=t.to,c=t.lastValue;c===void 0&&(c="");var v=function(y){return a[y]===r},g=function(y,h){for(var F="",V=0;V<y.length;V++)v(h+V)&&$(y[V])&&(F+=y[V]);return F},m=function(y){return y.replace(/[^0-9]/g,"")};if(!a.match(/\d/))return m(e);if(c===""&&e.length===a.length){for(var b="",d=0;d<e.length;d++)if(v(d))$(e[d])&&(b+=e[d]);else if(e[d]!==a[d])return m(e);return b}var p=c.substring(0,s.start),o=e.substring(f.start,f.end),I=c.substring(s.end);return""+g(p,0)+m(o)+g(I,s.end)}function et(e,t){var n=t.format,a=t.mask,r=t.patternChar;r===void 0&&(r="#");var s=Array.from({length:e.length+1}).map(function(){return!0}),f=0,c=-1,v={};n.split("").forEach(function(d,p){var o=void 0;d===r&&(f++,o=le(a,f-1),c===-1&&e[p]===o&&(c=p)),v[p]=o});for(var g=function(d){return n[d]===r&&e[d]!==v[d]},m=0,b=s.length;m<b;m++)s[m]=m===c||g(m)||g(m-1);return s[n.indexOf(r)]=!0,s}function tt(e){var t=e.mask;if(t){var n=t==="string"?t:t.toString();if(n.match(/\d/g))throw new Error("Mask "+t+" should not contain numeric character;")}}function rt(e,t){return e===""?!0:!(t!=null&&t.match(/\d/))&&typeof e=="string"&&(!!e.match(/^\d+$/)||e==="")}function nt(e){e.mask,e.allowEmptyFormatting;var t=e.format,n=e.inputMode;n===void 0&&(n="numeric");var a=e.onKeyDown;a===void 0&&(a=R);var r=e.patternChar;r===void 0&&(r="#");var s=e.value,f=e.defaultValue,c=e.valueIsNumericString,v=se(e,["mask","allowEmptyFormatting","format","inputMode","onKeyDown","patternChar","value","defaultValue","valueIsNumericString"]);tt(e);var g=function(o){return et(o,e)},m=function(o){var I=o.key,y=o.target,h=y.selectionStart,F=y.selectionEnd,V=y.value;if(h!==F){a(o);return}var A=h;if(I==="Backspace"||I==="Delete"){var O="right";if(I==="Backspace"){for(;A>0&&t[A-1]!==r;)A--;O="left"}else{for(var K=t.length;A<K&&t[A]!==r;)A++;O="right"}A=z(V,A,g(V),O)}else t[A]!==r&&I!=="ArrowLeft"&&I!=="ArrowRight"&&(A=z(V,A+1,g(V),"right"));A!==h&&Z(y,A),a(o)},b=H(s)?f:s,d=c??rt(b,t),p=Object.assign(Object.assign({},e),{valueIsNumericString:d});return Object.assign(Object.assign({},v),{value:s,defaultValue:f,valueIsNumericString:d,inputMode:n,format:function(o){return Je(o,p)},removeFormatting:function(o,I){return Ze(o,I,p)},getCaretBoundary:g,onKeyDown:m})}function oe(e){var t=nt(e);return D.createElement(Xe,Object.assign({},t))}const it=()=>{const e=we(),t=Ie(),[n,a]=M.useState(!1),{profileSettings:r}=je(),{originPath:s}=Ae(),{isScreenMobile:f}=Ee();M.useEffect(()=>{e(ae.setPaymentMethod(r))},[e,r]);const c=(m=0)=>{const b=new Date,d=b.getFullYear(),p=b.getMonth()+1,o=b.getDate()<10?`0${b.getDate()}`:`${b.getDate()}`;return`${+d+m}-0${p}-${o}`},v=Fe({initialValues:{cardName:r!==null?r.cardName:"",cardNumber:r!==null?r.cardNumber:"",expiration:r!==null?r.expiration:"",CVV:r!==null?r.CVV:""},validationSchema:Me({cardName:G().required("Required").min(3,"Must be 3 characters or more").max(20,"Must be 20 characters or less"),cardNumber:G().required("Required").test("cardNumber","Card number must be 16 characters",m=>m.split(" ").join("").length===16),expiration:G().required("Required").test("expiration","Card expiration date must be greater than today",m=>m>c()),CVV:G().required("Required")}),onSubmit:m=>{t.submit(m,{method:"PATCH"}),e(ae.setPaymentMethod(m)),a(!0)}}),g=m=>v.errors[m]&&v.touched[m];return x.jsxs(ke,{children:[f&&x.jsx(Oe,{page:"Payment Method"}),x.jsxs(k,{className:"d-flex flex-column mt-6 mt-lg-0",onSubmit:v.handleSubmit,children:[x.jsxs(k.Group,{className:"mb-2",children:[x.jsxs(k.Label,{className:"fw-medium",children:["Card Holder Name"," ",g("cardName")&&x.jsx("span",{className:"text-danger",children:" * "})]}),x.jsx(k.Control,{className:`p-3 ${g("cardName")?"border-danger":""}`,type:"text",id:"cardName",placeholder:"Enter card holder name",...v.getFieldProps("cardName")})]}),x.jsxs(k.Group,{className:"mb-2",children:[x.jsxs(k.Label,{className:"fw-medium",children:["Card Number"," ",g("cardNumber")&&x.jsx("span",{className:"text-danger",children:" * "})]}),x.jsx(oe,{id:"cardNumber",className:`p-3 ${g("cardNumber")?"border-danger":""}`,format:"#### #### #### ####",placeholder:"4111 1111 1111 1111",customInput:k.Control,...v.getFieldProps("cardNumber")})]}),x.jsxs("div",{className:"d-flex gap-2",children:[x.jsxs(k.Group,{className:"w-50",children:[x.jsxs(k.Label,{className:"fw-medium",children:["Expiration"," ",g("expiration")&&x.jsx("span",{className:"text-danger",children:" * "})]}),x.jsx(k.Control,{id:"expiration",className:`p-3 ${g("expiration")?"border-danger":""}`,type:"date",placeholder:"DD/MM/YY",min:c(),max:c(5),...v.getFieldProps("expiration")})]}),x.jsxs(k.Group,{className:"mb-3 w-50",children:[x.jsxs(k.Label,{className:"fw-medium",children:["CVV"," ",g("CVV")&&x.jsx("span",{className:"text-danger",children:" * "})]}),x.jsx(oe,{id:"CVV",className:`p-3 ${g("CVV")?"border-danger":""}`,format:"###",placeholder:"123",customInput:k.Control,...v.getFieldProps("CVV")})]})]}),x.jsx(ie,{variant:"dark",className:"p-3 align-self-md-end px-md-5 rounded-3 py-3 d-flex align-items-center justify-content-center gap-2",type:"submit",onClick:()=>v.setFieldValue("intent","payment"),children:"Save"})]}),x.jsxs(Pe,{title:"Your payment method has been saved",show:n,onClose:()=>a(!1),children:[x.jsx(ie,{variant:"white",onClick:()=>a(!1),children:"Close"}),x.jsx(Re,{to:`/${s}/profile`,className:"btn btn-dark",children:"Go to profile"})]})]})};export{it as default};
