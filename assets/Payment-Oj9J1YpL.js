import{y as D,r as M,F as we,v as Ie,x as je,a as Ae,b as Ee,I as ae,J as Fe,K as Me,M as G,j as C,d as ke,N as k,n as ie,Q as Oe,L as Pe}from"./index-m8s50vRk.js";function se(e,t){var r={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(r[a]=e[a]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,a=Object.getOwnPropertySymbols(e);n<a.length;n++)t.indexOf(a[n])<0&&Object.prototype.propertyIsEnumerable.call(e,a[n])&&(r[a[n]]=e[a[n]]);return r}var Y;(function(e){e.event="event",e.props="prop"})(Y||(Y={}));function R(){}function Re(e){var t,r=void 0;return function(){for(var a=[],n=arguments.length;n--;)a[n]=arguments[n];return t&&a.length===t.length&&a.every(function(s,f){return s===t[f]})||(t=a,r=e.apply(void 0,a)),r}}function $(e){return!!(e||"").match(/\d/)}function H(e){return e==null}function Te(e){return typeof e=="number"&&isNaN(e)}function De(e){return H(e)||Te(e)||typeof e=="number"&&!isFinite(e)}function Be(e){var t=M.useRef(e);t.current=e;var r=M.useRef(function(){for(var a=[],n=arguments.length;n--;)a[n]=arguments[n];return t.current.apply(t,a)});return r.current}function ue(e,t){return Array(t+1).join(e)}function _e(e){var t=e+"",r=t[0]==="-"?"-":"";r&&(t=t.substring(1));var a=t.split(/[eE]/g),n=a[0],s=a[1];if(s=Number(s),!s)return r+n;n=n.replace(".","");var f=1+s,c=n.length;return f<0?n="0."+ue("0",Math.abs(f))+n:f>=c?n=n+ue("0",f-c):n=(n.substring(0,f)||"0")+"."+n.substring(f),r+n}function Z(e,t){if(e.value=e.value,e!==null){if(e.createTextRange){var r=e.createTextRange();return r.move("character",t),r.select(),!0}return e.selectionStart||e.selectionStart===0?(e.focus(),e.setSelectionRange(t,t),!0):(e.focus(),!1)}}var Le=Re(function(e,t){for(var r=0,a=0,n=e.length,s=t.length;e[r]===t[r]&&r<n;)r++;for(;e[n-1-a]===t[s-1-a]&&s-a>r&&n-a>r;)a++;return{from:{start:r,end:n-a},to:{start:r,end:s-a}}});function $e(e,t,r){return Math.min(Math.max(e,t),r)}function X(e){return Math.max(e.selectionStart,e.selectionEnd)}function Ke(){return typeof navigator<"u"&&!(navigator.platform&&/iPhone|iPod/.test(navigator.platform))}function Ue(e){return{from:{start:0,end:0},to:{start:0,end:e.length},lastValue:""}}function le(e,t){return e===void 0&&(e=" "),typeof e=="string"?e:e[t]||" "}function qe(e){var t=e.currentValue,r=e.formattedValue,a=e.currentValueIndex,n=e.formattedValueIndex;return t[a]===r[n]}function Ge(e,t,r,a,n,s,f){f===void 0&&(f=qe);var c=n.findIndex(function(A){return A}),v=e.slice(0,c);!t&&!r.startsWith(v)&&(t=v,r=v+r,a=a+v.length);for(var g=r.length,m=e.length,b={},d=new Array(g),p=0;p<g;p++){d[p]=-1;for(var o=0,I=m;o<I;o++){var x=f({currentValue:r,lastValue:t,formattedValue:e,currentValueIndex:p,formattedValueIndex:o});if(x&&b[o]!==!0){d[p]=o,b[o]=!0;break}}}for(var h=a;h<g&&(d[h]===-1||!s(r[h]));)h++;var F=h===g||d[h]===-1?m:d[h];for(h=a-1;h>0&&d[h]===-1;)h--;var V=h===-1||d[h]===-1?0:d[h]+1;return V>F?F:a-V<F-a?V:F}function z(e,t,r,a){var n=e.length;if(t=$e(t,0,n),a==="left"){for(;t>=0&&!r[t];)t--;t===-1&&(t=r.indexOf(!0))}else{for(;t<=n&&!r[t];)t++;t>n&&(t=r.lastIndexOf(!0))}return t===-1&&(t=n),t}function Ye(e){for(var t=Array.from({length:e.length+1}).map(function(){return!0}),r=0,a=t.length;r<a;r++)t[r]=!!($(e[r])||$(e[r-1]));return t}function He(e,t,r,a,n,s){s===void 0&&(s=R);var f=Be(function(o,I){var x,h;return De(o)?(h="",x=""):typeof o=="number"||I?(h=typeof o=="number"?_e(o):o,x=a(h)):(h=n(o,void 0),x=a(h)),{formattedValue:x,numAsString:h}}),c=M.useState(function(){return f(H(e)?t:e,r)}),v=c[0],g=c[1],m=function(o,I){o.formattedValue!==v.formattedValue&&g({formattedValue:o.formattedValue,numAsString:o.value}),s(o,I)},b=e,d=r;H(e)&&(b=v.numAsString,d=!0);var p=f(b,d);return M.useMemo(function(){g(p)},[p.formattedValue]),[v,m]}function ze(e){return e.replace(/[^0-9]/g,"")}function Je(e){return e}function Qe(e){var t=e.type;t===void 0&&(t="text");var r=e.displayType;r===void 0&&(r="input");var a=e.customInput,n=e.renderText,s=e.getInputRef,f=e.format;f===void 0&&(f=Je);var c=e.removeFormatting;c===void 0&&(c=ze);var v=e.defaultValue,g=e.valueIsNumericString,m=e.onValueChange,b=e.isAllowed,d=e.onChange;d===void 0&&(d=R);var p=e.onKeyDown;p===void 0&&(p=R);var o=e.onMouseUp;o===void 0&&(o=R);var I=e.onFocus;I===void 0&&(I=R);var x=e.onBlur;x===void 0&&(x=R);var h=e.value,F=e.getCaretBoundary;F===void 0&&(F=Ye);var V=e.isValidInputCharacter;V===void 0&&(V=$);var A=e.isCharacterSame,O=se(e,["type","displayType","customInput","renderText","getInputRef","format","removeFormatting","defaultValue","valueIsNumericString","onValueChange","isAllowed","onChange","onKeyDown","onMouseUp","onFocus","onBlur","value","getCaretBoundary","isValidInputCharacter","isCharacterSame"]),K=He(h,v,!!g,f,c,m),ee=K[0],N=ee.formattedValue,U=ee.numAsString,fe=K[1],q=M.useRef({formattedValue:N,numAsString:U}),te=function(i,u){q.current={formattedValue:i.formattedValue,numAsString:i.value},fe(i,u)},re=M.useState(!1),ce=re[0],de=re[1],B=M.useRef(null),T=M.useRef({setCaretTimeout:null,focusTimeout:null});M.useEffect(function(){return de(!0),function(){clearTimeout(T.current.setCaretTimeout),clearTimeout(T.current.focusTimeout)}},[]);var ve=f,J=function(i,u){var l=parseFloat(u);return{formattedValue:i,value:u,floatValue:isNaN(l)?void 0:l}},P=function(i,u,l){i.selectionStart===0&&i.selectionEnd===i.value.length||(Z(i,u),T.current.setCaretTimeout=setTimeout(function(){i.value===l&&i.selectionStart!==i.selectionEnd&&Z(i,u)},0))},_=function(i,u,l){return z(i,u,F(i),l)},Q=function(i,u,l){var S=F(u),w=Ge(u,N,i,l,S,V,A);return w=z(u,w,S),w},me=function(i){var u=i.formattedValue;u===void 0&&(u="");var l=i.input,S=i.setCaretPosition;S===void 0&&(S=!0);var w=i.source,y=i.event,j=i.numAsString,E=i.caretPos;if(l){if(E===void 0&&S){var L=i.inputValue||l.value,W=X(l);l.value=u,E=Q(L,u,W)}l.value=u,S&&E!==void 0&&P(l,E,u)}u!==N&&te(J(u,j),{event:y,source:w})};M.useEffect(function(){var i=q.current,u=i.formattedValue,l=i.numAsString;N!==u&&(N!==U||u!==l)&&te(J(N,U),{event:void 0,source:Y.props})},[N,U]);var ge=B.current?X(B.current):void 0,he=typeof window<"u"?M.useLayoutEffect:M.useEffect;he(function(){var i=B.current;if(N!==q.current.formattedValue&&i){var u=Q(q.current.formattedValue,N,ge);i.value=N,P(i,u,N)}},[N]);var pe=function(i,u,l){var S=Le(N,i),w=Object.assign(Object.assign({},S),{lastValue:N}),y=c(i,w),j=ve(y);if(y=c(j,void 0),b&&!b(J(j,y))){var E=u.target,L=X(E),W=Q(i,N,L);return E.value=N,P(E,W,N),!1}return me({formattedValue:j,numAsString:y,inputValue:i,event:u,source:l,setCaretPosition:!0,input:u.target}),!0},xe=function(i){var u=i.target,l=u.value,S=pe(l,i,Y.event);S&&d(i)},ye=function(i){var u=i.target,l=i.key,S=u.selectionStart,w=u.selectionEnd,y=u.value;y===void 0&&(y="");var j;if(l==="ArrowLeft"||l==="Backspace"?j=Math.max(S-1,0):l==="ArrowRight"?j=Math.min(S+1,y.length):l==="Delete"&&(j=S),j===void 0||S!==w){p(i);return}var E=j;if(l==="ArrowLeft"||l==="ArrowRight"){var L=l==="ArrowLeft"?"left":"right";E=_(y,j,L),E!==j&&i.preventDefault()}else l==="Delete"&&!V(y[j])?E=_(y,j,"right"):l==="Backspace"&&!V(y[j])&&(E=_(y,j,"left"));E!==j&&P(u,E,y),i.isUnitTestRun&&P(u,E,y),p(i)},Ce=function(i){var u=i.target,l=u.selectionStart,S=u.selectionEnd,w=u.value;if(w===void 0&&(w=""),l===S){var y=_(w,l);y!==l&&P(u,y,w)}o(i)},be=function(i){i.persist&&i.persist();var u=i.target;B.current=u,T.current.focusTimeout=setTimeout(function(){var l=u.selectionStart,S=u.selectionEnd,w=u.value;w===void 0&&(w="");var y=_(w,l);y!==l&&!(l===0&&S===w.length)&&P(u,y,w),I(i)},0)},Ve=function(i){B.current=null,clearTimeout(T.current.focusTimeout),clearTimeout(T.current.setCaretTimeout),x(i)},Ne=ce&&Ke()?"numeric":void 0,ne=Object.assign({inputMode:Ne},O,{type:t,value:N,onChange:xe,onKeyDown:ye,onMouseUp:Ce,onFocus:be,onBlur:Ve});if(r==="text")return n?D.createElement(D.Fragment,null,n(N,O)||null):D.createElement("span",Object.assign({},O,{ref:s}),N);if(a){var Se=a;return D.createElement(Se,Object.assign({},ne,{ref:s}))}return D.createElement("input",Object.assign({},ne,{ref:s}))}function We(e,t){var r=t.format,a=t.allowEmptyFormatting,n=t.mask,s=t.patternChar;if(s===void 0&&(s="#"),e===""&&!a)return"";for(var f=0,c=r.split(""),v=0,g=r.length;v<g;v++)r[v]===s&&(c[v]=e[f]||le(n,f),f+=1);return c.join("")}function Xe(e,t,r){t===void 0&&(t=Ue(e));var a=r.format,n=r.patternChar;n===void 0&&(n="#");var s=t.from,f=t.to,c=t.lastValue;c===void 0&&(c="");var v=function(x){return a[x]===n},g=function(x,h){for(var F="",V=0;V<x.length;V++)v(h+V)&&$(x[V])&&(F+=x[V]);return F},m=function(x){return x.replace(/[^0-9]/g,"")};if(!a.match(/\d/))return m(e);if(c===""&&e.length===a.length){for(var b="",d=0;d<e.length;d++)if(v(d))$(e[d])&&(b+=e[d]);else if(e[d]!==a[d])return m(e);return b}var p=c.substring(0,s.start),o=e.substring(f.start,f.end),I=c.substring(s.end);return""+g(p,0)+m(o)+g(I,s.end)}function Ze(e,t){var r=t.format,a=t.mask,n=t.patternChar;n===void 0&&(n="#");var s=Array.from({length:e.length+1}).map(function(){return!0}),f=0,c=-1,v={};r.split("").forEach(function(d,p){var o=void 0;d===n&&(f++,o=le(a,f-1),c===-1&&e[p]===o&&(c=p)),v[p]=o});for(var g=function(d){return r[d]===n&&e[d]!==v[d]},m=0,b=s.length;m<b;m++)s[m]=m===c||g(m)||g(m-1);return s[r.indexOf(n)]=!0,s}function et(e){var t=e.mask;if(t){var r=t==="string"?t:t.toString();if(r.match(/\d/g))throw new Error("Mask "+t+" should not contain numeric character;")}}function tt(e,t){return e===""?!0:!(t!=null&&t.match(/\d/))&&typeof e=="string"&&(!!e.match(/^\d+$/)||e==="")}function rt(e){e.mask,e.allowEmptyFormatting;var t=e.format,r=e.inputMode;r===void 0&&(r="numeric");var a=e.onKeyDown;a===void 0&&(a=R);var n=e.patternChar;n===void 0&&(n="#");var s=e.value,f=e.defaultValue,c=e.valueIsNumericString,v=se(e,["mask","allowEmptyFormatting","format","inputMode","onKeyDown","patternChar","value","defaultValue","valueIsNumericString"]);et(e);var g=function(o){return Ze(o,e)},m=function(o){var I=o.key,x=o.target,h=x.selectionStart,F=x.selectionEnd,V=x.value;if(h!==F){a(o);return}var A=h;if(I==="Backspace"||I==="Delete"){var O="right";if(I==="Backspace"){for(;A>0&&t[A-1]!==n;)A--;O="left"}else{for(var K=t.length;A<K&&t[A]!==n;)A++;O="right"}A=z(V,A,g(V),O)}else t[A]!==n&&I!=="ArrowLeft"&&I!=="ArrowRight"&&(A=z(V,A+1,g(V),"right"));A!==h&&Z(x,A),a(o)},b=H(s)?f:s,d=c??tt(b,t),p=Object.assign(Object.assign({},e),{valueIsNumericString:d});return Object.assign(Object.assign({},v),{value:s,defaultValue:f,valueIsNumericString:d,inputMode:r,format:function(o){return We(o,p)},removeFormatting:function(o,I){return Xe(o,I,p)},getCaretBoundary:g,onKeyDown:m})}function oe(e){var t=rt(e);return D.createElement(Qe,Object.assign({},t))}const at=()=>{const e=we(),t=Ie(),[r,a]=M.useState(!1),{profileSettings:n}=je(),{originPath:s}=Ae(),{renderHeader:f}=Ee();M.useEffect(()=>{e(ae.setPaymentMethod(n))},[e,n]);const c=(m=0)=>{const b=new Date,d=b.getFullYear(),p=b.getMonth()+1,o=b.getDate()<10?`0${b.getDate()}`:`${b.getDate()}`;return`${+d+m}-0${p}-${o}`},v=Fe({initialValues:{cardName:n.cardName,cardNumber:n.cardNumber,expiration:n.expiration,CVV:n.CVV},validationSchema:Me({cardName:G().required("Required").min(3,"Must be 3 characters or more").max(20,"Must be 20 characters or less"),cardNumber:G().required("Required").test("cardNumber","Card number must be 16 characters",m=>m.split(" ").join("").length===16),expiration:G().required("Required").test("expiration","Card expiration date must be greater than today",m=>m>c()),CVV:G().required("Required")}),onSubmit:m=>{t.submit(m,{method:"PATCH"}),e(ae.setPaymentMethod(m)),a(!0)}}),g=m=>v.errors[m]&&v.touched[m];return C.jsxs(ke,{children:[f("Payment Method"),C.jsxs(k,{className:"d-flex flex-column mt-6",onSubmit:v.handleSubmit,children:[C.jsxs(k.Group,{className:"mb-2",children:[C.jsxs(k.Label,{className:"fw-medium",children:["Card Holder Name"," ",g("cardName")&&C.jsx("span",{className:"text-danger",children:" * "})]}),C.jsx(k.Control,{className:`p-3 ${g("cardName")?"border-danger":""}`,type:"text",id:"cardName",placeholder:"Enter card holder name",...v.getFieldProps("cardName")})]}),C.jsxs(k.Group,{className:"mb-2",children:[C.jsxs(k.Label,{className:"fw-medium",children:["Card Number"," ",g("cardNumber")&&C.jsx("span",{className:"text-danger",children:" * "})]}),C.jsx(oe,{id:"cardNumber",className:`p-3 ${g("cardNumber")?"border-danger":""}`,format:"#### #### #### ####",placeholder:"4111 1111 1111 1111",customInput:k.Control,...v.getFieldProps("cardNumber")})]}),C.jsxs("div",{className:"d-flex gap-2",children:[C.jsxs(k.Group,{className:"w-50",children:[C.jsxs(k.Label,{className:"fw-medium",children:["Expiration"," ",g("expiration")&&C.jsx("span",{className:"text-danger",children:" * "})]}),C.jsx(k.Control,{id:"expiration",className:`p-3 ${g("expiration")?"border-danger":""}`,type:"date",placeholder:"DD/MM/YY",min:c(),max:c(5),...v.getFieldProps("expiration")})]}),C.jsxs(k.Group,{className:"mb-3 w-50",children:[C.jsxs(k.Label,{className:"fw-medium",children:["CVV"," ",g("CVV")&&C.jsx("span",{className:"text-danger",children:" * "})]}),C.jsx(oe,{id:"CVV",className:`p-3 ${g("CVV")?"border-danger":""}`,format:"###",placeholder:"123",customInput:k.Control,...v.getFieldProps("CVV")})]})]}),C.jsx(ie,{variant:"dark",className:"p-3 align-self-md-end px-md-5 rounded-3 py-3 d-flex align-items-center justify-content-center gap-2",type:"submit",onClick:()=>v.setFieldValue("intent","payment"),children:"Save"})]}),C.jsxs(Oe,{title:"Your payment method has been saved",show:r,onClose:()=>a(!1),children:[C.jsx(ie,{variant:"white",onClick:()=>a(!1),children:"Close"}),C.jsx(Pe,{to:`/${s}/profile`,className:"btn btn-dark",children:"Go to profile"})]})]})};export{at as default};
